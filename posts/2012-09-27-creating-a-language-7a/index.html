<!doctype html><html><head><title>Making a programming language Part 7a - objects</title><meta charset=utf-8><meta name=X-UA-Compatible content="IE=edge"><meta name=google-site-verification content><meta content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=0" name=viewport><meta content="telephone=no" name=format-detection><meta name=renderer content="webkit"><meta name=theme-color content="#ffffff"><link type=text/css rel=stylesheet href=/vendor/css/bootstrap.min.css><link rel=stylesheet href=/scss/journal.min.01c37d732f853bf90329007dc6f0a25c67722dd47b7168f8907facb93414bd91.css media=screen><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Lora|Montserrat|Fira+Mono|Noto+Serif+SC|Material+Icons"></head><body><div id=app><div ref=sideContainer class=side-container><div class="a-block nav-head false"><div class=nav-title>My Programming Escapades</div><div class=nav-subtitle>Andraz Bajt</div><a href=https://github.com/edofic><img src=/icons/github.svg width=20></a>
<a href=https://www.linkedin.com/in/edofic><img src=/icons/linkedin.svg width=20></a>
<a href=https://twitter.com/edofic><img src=/icons/twitter.svg width=20></a>
<a href=/index.xml><img src=/icons/rss.svg width=20></a>
<a href=mailto:edofic@edofic.com><img src=/icons/email.svg width=20></a></div><div class=nav-link-list><a class="a-block nav-link-item" href=/about>About Me</a>
<a class="a-block nav-link-item" href=/>Archive</a></div><div class=nav-footer>&copy;
2021
Andraz Bajt</div></div><div ref=extraContainer class=extra-container><div class=pagination><a id=globalBackToTop class="pagination-action animated-visibility" href=#top :class="{ invisible: scrollY == 0 }"><i class="material-icons pagination-action-icon">keyboard_arrow_up</i></a></div></div><div class=single-column-drawer-container ref=drawer><div class=drawer-content><div class=drawer-menu><a class="a-block drawer-menu-item" href=/about>About Me</a>
<a class="a-block drawer-menu-item" href=/>Archive</a></div></div></div><div class=single-column-header-container ref=pageHead><a href=/><div class=single-column-header-title>My Programming Escapades</div><div class=single-column-header-subtitle>Andraz Bajt</div></a><a href=https://github.com/edofic><img src=/icons/github.svg width=20></a>
<a href=https://www.linkedin.com/in/edofic><img src=/icons/linkedin.svg width=20></a>
<a href=https://twitter.com/edofic><img src=/icons/twitter.svg width=20></a>
<a href=/index.xml><img src=/icons/rss.svg width=20></a>
<a href=mailto:edofic@edofic.com><img src=/icons/email.svg width=20></a></div><div id=content><div ref=streamContainer class=stream-container><div class="post-list-container post-list-container-shadow"><div class=post><div class=post-head-wrapper-text-only style="background-image:url('/')"><div class=post-title>Making a programming language Part 7a - objects<div class=post-meta><time itemprop=datePublished>2012-09-27</time></div></div></div><div class=post-body-wrapper><div class=post-body><p><a href=/posts/2012-08-29-creating-a-language-1>Table of contents</a>, 
<a href=https://github.com/edofic/scrat-lang>Whole project on github</a></p><p>My goal in this post is for this to compile</p><pre><code>func create(n){this}
</code></pre><p>and a call to it to return a reference to an
<a href=http://en.wikipedia.org/wiki/Object_%28computer_science%29 title="Object (computer science)">object</a>
that contains &ldquo;n&rdquo;. Functions are a bit different from the rest of the
language. Not by
<a href=http://en.wikipedia.org/wiki/Implementation title=Implementation>implementation</a>
or usage but by <a href=http://en.wikipedia.org/wiki/Thought title=Thought>thought
process</a> behind
designing them. I actually thought about objects and
<a href=http://en.wikipedia.org/wiki/Function_%28mathematics%29 title="Function (mathematics)">functions</a>
before implementing any of them. Considering my implementation of
scopes(which I like) and shadowing I got this great idea that functions,
scopes and objects are just many faces of the same thing. Or &ldquo;could be&rdquo;
many faces of the same thing. Something a bit more powerful than a
function being the &ldquo;thing&rdquo;. Let&rsquo;s see how that works. A function in this
language needs a new <a href=http://en.wikipedia.org/wiki/Local_variable title="Local variable">local
scope</a> for
every execution(not all functions, but this is a simplification because
I don&rsquo;t care about performance, see <a href=/posts/2012-09-25-creating-a-language-6>previous
post</a>
for details). New scope. New something. New. Bells should be ringing
right now. I&rsquo;m creating objects. I could just as well pass the reference
to that object. I even have the reference. It&rsquo;s current scope - &ldquo;this&rdquo;
in scala code. So I just need a <a href=http://en.wikipedia.org/wiki/Language_construct title="Language construct">language
construct</a>
to access that. How about &ldquo;this&rdquo;.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-scala data-lang=scala><span style=color:#75715e>//in SScope body
</span><span style=color:#75715e></span>map<span style=color:#f92672>.</span>put<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;this&#34;</span><span style=color:#f92672>,</span> <span style=color:#66d9ef>this</span><span style=color:#f92672>)</span>
</code></pre></div><p>Not even a language construct, just a magic variable. You can even
shadow it. Anticlimactic? I hope so. The whole point of object is that
it&rsquo;s just another view on function. I could end the post here but I want
to show why this is awesome(and therefore why I&rsquo;m proud of it)</p><h3 id=privates>Privates</h3><p>You don&rsquo;t even need access modifiers, you can use shadowing and nesting</p><pre><code>func private(n) {
    that = this
    func (){
        func get() { that.n }
        func set(v) { that.n = v }
        this
    }()
}
</code></pre><p>This is a constructor that returns an object with functions get and
set(but no n!). Outer object is available through its alias via nesting.
And returned value is the last expression - an immediately invoked
lambda(cumbersome syntax..gotta do something about that). However, this
is not bullet-proof</p><pre><code>o = private(1)
o.that = func(){
           n=3
           this
         }
o.get()
</code></pre><p>Returns 3. Though knowledge of implementation is needed to execute such
attack. <strong>update:</strong> I kinda sorta forgot to include how I made that
dot-access thingy-o.get() to work. Continuation below</p><p><strong>next: <a href=/posts/2012-10-08-creating-a-language-7b>using objects</a></strong></p><hr width=100%><p style=color:#777>Last modified on 2012-09-27</p></div></div><nav class=post-pagination><a class=newer-posts href=/posts/2012-09-29-creating-a-language-8/>Next<br>Making a programming language Part 8 - going faster</a>
<a class=older-posts href=/posts/2012-09-25-creating-a-language-6/>Previous<br>Making a programming language Part 6 - functions</a></nav><div class=post-comment-wrapper></div></div></div></div></div><div id=single-column-footer>&copy;
2021
Andraz Bajt</div></div></body></html>