<!DOCTYPE html>
<html><head>
<title>Integrating Jira into Google Sheets</title>

<meta charset="utf-8">
<meta name="X-UA-Compatible" content="IE=edge">
<meta name="google-site-verification" content="">
<meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport">
<meta content="telephone=no" name="format-detection">
<meta name="renderer" content="webkit">
<meta name="theme-color" content="#ffffff">




<script src="/vendor/js/jquery.min.js" ></script>
<script src="/vendor/js/popper.min.js" ></script>
<script src="/vendor/js/bootstrap.min.js" ></script>
<script src="/vendor/js/smooth-scroll.polyfills.min.js" ></script>
<link type="text/css" rel="stylesheet" href="/vendor/css/bootstrap.min.css">
<script src="/vendor/js/vue.min.js" ></script>



<link rel="stylesheet" href="/scss/journal.min.9d1b3d6c4f3ff1773fff9bdca1bc24452f33129e12f67f2ab14f2ddaf1603468.css" media="screen">

<script src="/js/loadCSS.js"></script>
<script>
    loadCSS("https://fonts.googleapis.com/css?family=Lora|Montserrat|Fira+Mono|Noto+Serif+SC|Material+Icons");
</script>

</head>
<body>
    	<div id="app"><div ref="sideContainer" class="side-container">
    <div class="a-block nav-head false">
        <div class="nav-title">
            My Programming Escapades
        </div>
        <div class="nav-subtitle">
            
                Andraz Bajt
            
        </div>
            
                <a href="https://github.com/edofic"><img src="/icons/github.svg" width="20"/></a>
            
            
                <a href="https://www.linkedin.com/in/edofic"><img src="/icons/linkedin.svg" width="20"/></a>
            
            
                <a href="https://twitter.com/edofic"><img src="/icons/twitter.svg" width="20"/></a>
            
            <a href="/index.xml"><img src="/icons/rss.svg" width="20"/></a>
            
                <a href="mailto:edofic@edofic.com"><img src="/icons/email.svg" width="20"/></a>
            
    </div>


    <div class="nav-link-list">
        
        
            
            
            <a class="a-block nav-link-item" href="/about">
                About Me
            </a>
        
            
            
            <a class="a-block nav-link-item" href="/">
                Archive
            </a>
        
    </div>

    <div class="nav-footer">
        &copy;
    2020
	
	Andraz Bajt
	

    </div>

</div>
<div ref="extraContainer" class="extra-container">
    
    <div class="pagination">
        <a id="globalBackToTop" class="pagination-action animated-visibility" href="#top" :class="{ invisible: scrollY == 0 }">
            <i class="material-icons pagination-action-icon">
                keyboard_arrow_up
            </i>
        </a>
        
    </div>
</div><div class="single-column-drawer-container" ref="drawer"
     v-bind:class="{ 'single-column-drawer-container-active': isDrawerOpen }">
    <div class="drawer-content">
        <div class="drawer-menu">
        
        
            
                
                
                <a class="a-block drawer-menu-item" href="/about">
                    About Me
                </a>
        
            
                
                
                    
                
                <a class="a-block drawer-menu-item" href="/">
                    Archive
                </a>
        
        </div>
    </div>
</div>
<transition name="fade">
    <div v-bind:class="{ 'single-column-drawer-mask': mounted }" v-if="isDrawerOpen" v-on:click="toggleDrawer"></div>
</transition>
<nav ref="navBar" class="navbar sticky-top navbar-light single-column-nav-container">
    <div ref="navBackground" class="nav-background"></div>
    <div class="container container-narrow nav-content">
        <button id="nav_dropdown_btn" class="nav-dropdown-toggle" type="button" v-on:click="toggleDrawer">
            <i class="material-icons">
                menu
            </i>
        </button>
        <a ref="navTitle" class="navbar-brand" href="/">
            My Programming Escapades
        </a>
    </div>
</nav>
<div class="single-column-header-container" ref="pageHead"
     v-bind:style="{ transform: 'translateZ(0px) translateY('+.3*scrollY+'px)', opacity: 1-navOpacity }">
        <a href="/">
            <div class="single-column-header-title">My Programming Escapades</div>
            
            <div class="single-column-header-subtitle">Andraz Bajt</div>
            
        </a>

        
            <a href="https://github.com/edofic"><img src="/icons/github.svg" width="20"/></a>
        
        
            <a href="https://www.linkedin.com/in/edofic"><img src="/icons/linkedin.svg" width="20"/></a>
        
        
            <a href="https://twitter.com/edofic"><img src="/icons/twitter.svg" width="20"/></a>
        
        <a href="/index.xml"><img src="/icons/rss.svg" width="20"/></a>
        
            <a href="mailto:edofic@edofic.com"><img src="/icons/email.svg" width="20"/></a>
        

</div>

            <div id="content">
<div ref="streamContainer" class="stream-container">
    <div class="post-list-container post-list-container-shadow">
        <div class="post">
            
            
            

            <div class="post-head-wrapper-text-only"
                 style="background-image: url('/')">
                <div class="post-title">
                    Integrating Jira into Google Sheets
                    <div class="post-meta">
                        
                            <time itemprop="datePublished">
                                2018-01-25
                            </time>
                        

                        

                        
                    </div>
                </div>
            </div>

            <div class="post-body-wrapper">
                <div class="post-body">
                    <p>So I got a (recurring) task to compile some stats from Jira. You now, some
filtering and agregation. Possibly a pivot table and a chart. Sounds like a
perfect task for spreadsheets. But Jira doesn't have spreadsheets - at least
without addons, but that is not an options for me.</p>
<p>So I decided to use Google Sheets. And figure out a way to automatically fetch
data from Jira because there's no way in hell I'm doing that manually every
time. Turns out there are some scripts you are supposed to paste into sheets and
give them all the permissions. But I don't trust that, not without  properly
reviewing the thousands of lines of code.</p>
<p>Obviously I decided to roll my own. I figured a way that's actually really easy.
Just create a filter in Jira and click <code>Export -&gt; Printable</code>. This will give you
an URL with all your tickets formatted nicely in a <code>&lt;table&gt;</code>.:</p>
<p>Why is this useful? Because Google Sheets knows how to scrape HTML tables. If
you append your credentials to the url. The whole formula will look something
like this:</p>
<pre><code>=IMPORTHTML(&quot;https://my_instance.atlassian.net/sr/jira.issueviews:searchrequest-printable/14900/SearchRequest-14900.html?tempMax=1000&amp;os_username=my_username&amp;os_password=my_password&quot;, &quot;table&quot;, 1)
</code></pre><p>This magically pulls your Jira table into a spreadsheet. Now you can use all
your spreadsheet tools to make reports out of this. Or even SQL! Google Sheets
has a <code>QUERY</code> function which takes a data range and an SQL-like expression to
run over it.</p>
<p>Now we just need a way to simply refresh the data (remember, this is a recurring
task). Sheet re-load the data when the URL changes and Jira ignores unknown
parameters. We can use this to add a dummy counter which we increment!</p>
<pre><code>=IMPORTHTML(CONCATENATE(&quot;https://...my_passoword&amp;dummy=&quot;, B1), &quot;table&quot;, 1)
</code></pre><p>But this means we now need to edit a number. No fun. Let's write a script to do
it.</p>
<p>In <code>Tools</code> -&gt; <code>Script Editor</code></p>
<pre><code>function increment() {
  SpreadsheetApp.getActiveSheet().getRange('B1').setValue(SpreadsheetApp.getActiveSheet().getRange('B1').getValue() + 1);
}
</code></pre><p>Now we just need a way to run it.</p>
<ol>
<li>insert a drawing</li>
<li>right click</li>
<li>assign a script</li>
</ol>
<p>Voila we have a button!</p>

                    <HR width="100%">
                    
                    <p style="color:#777;">Last modified on 2018-01-25</p>
                    
                </div>

            </div>


            <nav class="post-pagination">

                
                <a class="newer-posts" href="/posts/2018-05-25-linear-time-sorting/">
                    Next<br>Linear time sorting
                </a>
                

                
                <a class="older-posts" href="/posts/2018-01-24-nixos-install-pains/">
                    Previous<br>NixOS install &amp; labor pains
                </a>
                
            </nav>
            <div class="post-comment-wrapper">
                



            </div>
        </div>
    </div>
</div>

            </div><div id="single-column-footer">&copy;
    2020
	
	Andraz Bajt
	
</div>
    	</div>
    <script src="//js/journal.js"></script>
    </body>
</html>
