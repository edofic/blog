<!doctype html><html><head><title>Integrating Jira into Google Sheets</title><meta charset=utf-8><meta name=X-UA-Compatible content="IE=edge"><meta name=google-site-verification content><meta content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=0" name=viewport><meta content="telephone=no" name=format-detection><meta name=renderer content="webkit"><meta name=theme-color content="#ffffff"><link type=text/css rel=stylesheet href=/vendor/css/bootstrap.min.css><link rel=stylesheet href=/scss/journal.min.01c37d732f853bf90329007dc6f0a25c67722dd47b7168f8907facb93414bd91.css media=screen><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Lora|Montserrat|Fira+Mono|Noto+Serif+SC|Material+Icons"></head><body><div id=app><div ref=sideContainer class=side-container><div class="a-block nav-head false"><div class=nav-title>My Programming Escapades</div><div class=nav-subtitle>Andraz Bajt</div><a href=https://github.com/edofic><img src=/icons/github.svg width=20></a>
<a href=https://www.linkedin.com/in/edofic><img src=/icons/linkedin.svg width=20></a>
<a href=https://twitter.com/edofic><img src=/icons/twitter.svg width=20></a>
<a href=/index.xml><img src=/icons/rss.svg width=20></a>
<a href=mailto:edofic@edofic.com><img src=/icons/email.svg width=20></a></div><div class=nav-link-list><a class="a-block nav-link-item" href=/about>About Me</a>
<a class="a-block nav-link-item" href=/>Archive</a></div><div class=nav-footer>&copy;
2021
Andraz Bajt</div></div><div ref=extraContainer class=extra-container><div class=pagination><a id=globalBackToTop class="pagination-action animated-visibility" href=#top :class="{ invisible: scrollY == 0 }"><i class="material-icons pagination-action-icon">keyboard_arrow_up</i></a></div></div><div class=single-column-drawer-container ref=drawer><div class=drawer-content><div class=drawer-menu><a class="a-block drawer-menu-item" href=/about>About Me</a>
<a class="a-block drawer-menu-item" href=/>Archive</a></div></div></div><div class=single-column-header-container ref=pageHead><a href=/><div class=single-column-header-title>My Programming Escapades</div><div class=single-column-header-subtitle>Andraz Bajt</div></a><a href=https://github.com/edofic><img src=/icons/github.svg width=20></a>
<a href=https://www.linkedin.com/in/edofic><img src=/icons/linkedin.svg width=20></a>
<a href=https://twitter.com/edofic><img src=/icons/twitter.svg width=20></a>
<a href=/index.xml><img src=/icons/rss.svg width=20></a>
<a href=mailto:edofic@edofic.com><img src=/icons/email.svg width=20></a></div><div id=content><div ref=streamContainer class=stream-container><div class="post-list-container post-list-container-shadow"><div class=post><div class=post-head-wrapper-text-only style="background-image:url('/')"><div class=post-title>Integrating Jira into Google Sheets<div class=post-meta><time itemprop=datePublished>2018-01-25</time></div></div></div><div class=post-body-wrapper><div class=post-body><p>So I got a (recurring) task to compile some stats from Jira. You now, some
filtering and agregation. Possibly a pivot table and a chart. Sounds like a
perfect task for spreadsheets. But Jira doesn&rsquo;t have spreadsheets - at least
without addons, but that is not an options for me.</p><p>So I decided to use Google Sheets. And figure out a way to automatically fetch
data from Jira because there&rsquo;s no way in hell I&rsquo;m doing that manually every
time. Turns out there are some scripts you are supposed to paste into sheets and
give them all the permissions. But I don&rsquo;t trust that, not without properly
reviewing the thousands of lines of code.</p><p>Obviously I decided to roll my own. I figured a way that&rsquo;s actually really easy.
Just create a filter in Jira and click <code>Export -> Printable</code>. This will give you
an URL with all your tickets formatted nicely in a <code>&lt;table></code>.:</p><p>Why is this useful? Because Google Sheets knows how to scrape HTML tables. If
you append your credentials to the url. The whole formula will look something
like this:</p><pre><code>=IMPORTHTML(&quot;https://my_instance.atlassian.net/sr/jira.issueviews:searchrequest-printable/14900/SearchRequest-14900.html?tempMax=1000&amp;os_username=my_username&amp;os_password=my_password&quot;, &quot;table&quot;, 1)
</code></pre><p>This magically pulls your Jira table into a spreadsheet. Now you can use all
your spreadsheet tools to make reports out of this. Or even SQL! Google Sheets
has a <code>QUERY</code> function which takes a data range and an SQL-like expression to
run over it.</p><p>Now we just need a way to simply refresh the data (remember, this is a recurring
task). Sheet re-load the data when the URL changes and Jira ignores unknown
parameters. We can use this to add a dummy counter which we increment!</p><pre><code>=IMPORTHTML(CONCATENATE(&quot;https://...my_passoword&amp;dummy=&quot;, B1), &quot;table&quot;, 1)
</code></pre><p>But this means we now need to edit a number. No fun. Let&rsquo;s write a script to do
it.</p><p>In <code>Tools</code> -> <code>Script Editor</code></p><pre><code>function increment() {
  SpreadsheetApp.getActiveSheet().getRange('B1').setValue(SpreadsheetApp.getActiveSheet().getRange('B1').getValue() + 1);
}
</code></pre><p>Now we just need a way to run it.</p><ol><li>insert a drawing</li><li>right click</li><li>assign a script</li></ol><p>Voila we have a button!</p><hr width=100%><p style=color:#777>Last modified on 2018-01-25</p></div></div><nav class=post-pagination><a class=newer-posts href=/posts/2018-05-25-linear-time-sorting/>Next<br>Linear time sorting</a>
<a class=older-posts href=/posts/2018-01-24-nixos-install-pains/>Previous<br>NixOS install & labor pains</a></nav><div class=post-comment-wrapper></div></div></div></div></div><div id=single-column-footer>&copy;
2021
Andraz Bajt</div></div></body></html>