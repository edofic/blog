<!doctype html><html><head><title>Power sets</title><meta charset=utf-8><meta name=X-UA-Compatible content="IE=edge"><meta name=google-site-verification content><meta content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=0" name=viewport><meta content="telephone=no" name=format-detection><meta name=renderer content="webkit"><meta name=theme-color content="#ffffff"><script src=/vendor/js/jquery.min.js></script><script src=/vendor/js/popper.min.js></script><script src=/vendor/js/bootstrap.min.js></script><script src=/vendor/js/smooth-scroll.polyfills.min.js></script><link type=text/css rel=stylesheet href=/vendor/css/bootstrap.min.css><script src=/vendor/js/vue.min.js></script><link rel=stylesheet href=/scss/journal.min.3bdd3e0bba961aa48fdce1402e6f01783c435b4dfb0025c8d0022ddaea0f3d19.css media=screen><script src=/js/loadCSS.js></script><script>loadCSS("https://fonts.googleapis.com/css?family=Lora|Montserrat|Fira+Mono|Noto+Serif+SC|Material+Icons");</script></head><body><div id=app><div ref=sideContainer class=side-container><div class="a-block nav-head false"><div class=nav-title>My Programming Escapades</div><div class=nav-subtitle>Andraz Bajt</div><a href=https://github.com/edofic><img src=/icons/github.svg width=20></a>
<a href=https://www.linkedin.com/in/edofic><img src=/icons/linkedin.svg width=20></a>
<a href=https://twitter.com/edofic><img src=/icons/twitter.svg width=20></a>
<a href=/index.xml><img src=/icons/rss.svg width=20></a>
<a href=mailto:edofic@edofic.com><img src=/icons/email.svg width=20></a></div><div class=nav-link-list><a class="a-block nav-link-item" href=/about>About Me</a>
<a class="a-block nav-link-item" href=/>Archive</a></div><div class=nav-footer>&copy;
2021
Andraz Bajt</div></div><div ref=extraContainer class=extra-container><div class=pagination><a id=globalBackToTop class="pagination-action animated-visibility" href=#top :class="{ invisible: scrollY == 0 }"><i class="material-icons pagination-action-icon">keyboard_arrow_up</i></a></div></div><div class=single-column-drawer-container ref=drawer v-bind:class="{ 'single-column-drawer-container-active': isDrawerOpen }"><div class=drawer-content><div class=drawer-menu><a class="a-block drawer-menu-item" href=/about>About Me</a>
<a class="a-block drawer-menu-item" href=/>Archive</a></div></div></div><transition name=fade><div v-bind:class="{ 'single-column-drawer-mask': mounted }" v-if=isDrawerOpen v-on:click=toggleDrawer></div></transition><nav ref=navBar class="navbar sticky-top navbar-light single-column-nav-container"><div ref=navBackground class=nav-background></div><div class="container container-narrow nav-content"><button id=nav_dropdown_btn class=nav-dropdown-toggle type=button v-on:click=toggleDrawer>
<i class=material-icons>menu</i></button>
<a ref=navTitle class=navbar-brand href=/>My Programming Escapades</a></div></nav><div class=single-column-header-container ref=pageHead v-bind:style="{ transform: 'translateZ(0px) translateY('+.3*scrollY+'px)', opacity: 1-navOpacity }"><a href=/><div class=single-column-header-title>My Programming Escapades</div><div class=single-column-header-subtitle>Andraz Bajt</div></a><a href=https://github.com/edofic><img src=/icons/github.svg width=20></a>
<a href=https://www.linkedin.com/in/edofic><img src=/icons/linkedin.svg width=20></a>
<a href=https://twitter.com/edofic><img src=/icons/twitter.svg width=20></a>
<a href=/index.xml><img src=/icons/rss.svg width=20></a>
<a href=mailto:edofic@edofic.com><img src=/icons/email.svg width=20></a></div><div id=content><div ref=streamContainer class=stream-container><div class="post-list-container post-list-container-shadow"><div class=post><div class=post-head-wrapper-text-only style="background-image:url('/')"><div class=post-title>Power sets<div class=post-meta><time itemprop=datePublished>2012-09-21</time></div></div></div><div class=post-body-wrapper><div class=post-body><p>It all started out when a friend of mine(<a href=http://naspletu.org/>check him out</a>)
told me a story about someone having an
interview at <a href=http://google.com/ title=Google>Google</a>. He was <a href=http://en.wikipedia.org/wiki/Live_coding title="Live coding">live
coding</a> and
asked to implement a function that computes a <a href=http://en.wikipedia.org/wiki/Power_set title="Power set">power
set</a> of a given set.
He totaly over-engineered it and after an hour of fiddling came up with
4-liner in python. Ok. Big deal. How hard can it be? I immediately
started to brainstorm a solution of my own(and Matevž helped).
Paraphrased train of thought below.
So what is a power set? Say a power set of set A. It's a set of all
<a href=http://en.wikipedia.org/wiki/Subset title=Subset>subsets</a> of A. It's all
possible combinations of including and excluding single elements. So
it's like applying filters to the original set. Wait a sec, a set of
size n has 2 to the n-th power subsets. It all matches up. N-bit number
are said filters. So you count from 0 to 2^n-1 you enumerate exactly
all the filters and therefore all the subsets. You just calculated the
power set. This took about 30sec in real time. Another minute to sketch
the implementation. You implement set as Lists. Let's say
<a href=http://www.oracle.com/technetwork/java/ title="Java (programming language)">Java</a>
is the language of choice. Any reasonable input would be shorter than
64 elements, at least on current machinery. So long can be used as
counter. And now a nested for loop to iterate over elements and
appending them if counter && (1 &#171; n). Simple. Won't post the code
since I never wrote it.</p><h3 id=the-original-blogpost>The original blogpost</h3><p>This happened in a lab at Faculty for Computer and Information science.
On my way home I started thinkking&mldr;.what is that 4-line
implementation? It can't be my algorithm, that won't fit - it just isn't
that elegant. Matevž also told me who was the original author and it was
someone whose blog I was subscribed to(I still am, it's pretty awesome,
<a href=http://swizec.com/>check it out</a>). So I searched for the original
blogpost. And <a href=http://swizec.com/blog/a-google-phone-interview/swizec/3813>found
it</a>. It
wasn't four lines.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-scala data-lang=scala><span style=color:#66d9ef>def</span> powerset<span style=color:#f92672>(</span>set<span style=color:#f92672>)</span><span style=color:#66d9ef>:</span>
      <span style=color:#66d9ef>binaries</span> <span style=color:#f92672>=</span> <span style=color:#f92672>[</span><span style=color:#66d9ef>bin</span><span style=color:#f92672>(</span><span style=color:#66d9ef>a</span><span style=color:#f92672>)</span> <span style=color:#66d9ef>for</span> <span style=color:#66d9ef>a</span> <span style=color:#66d9ef>in</span> <span style=color:#66d9ef>range</span><span style=color:#f92672>(</span><span style=color:#960050;background-color:#1e0010>2</span><span style=color:#66d9ef>^</span><span style=color:#66d9ef>len</span><span style=color:#f92672>(</span><span style=color:#66d9ef>set</span><span style=color:#f92672>)</span><span style=color:#f92672>)</span><span style=color:#f92672>]</span>
      power <span style=color:#66d9ef>=</span> <span style=color:#f92672>[</span><span style=color:#f92672>]</span>
      <span style=color:#66d9ef>for</span> yeses in binaries<span style=color:#66d9ef>:</span>
        <span style=color:#66d9ef>subset</span> <span style=color:#f92672>=</span> <span style=color:#f92672>[</span><span style=color:#f92672>]</span>
 yeses <span style=color:#66d9ef>=</span> str<span style=color:#f92672>(</span>yeses<span style=color:#f92672>)</span>
 <span style=color:#66d9ef>for</span> i in range<span style=color:#f92672>(</span>len<span style=color:#f92672>(</span>yeses<span style=color:#f92672>)</span><span style=color:#f92672>)</span><span style=color:#66d9ef>:</span>
                 <span style=color:#66d9ef>if</span> <span style=color:#66d9ef>yeses</span><span style=color:#f92672>[</span><span style=color:#66d9ef>i</span><span style=color:#f92672>]</span> <span style=color:#f92672>==</span> <span style=color:#960050;background-color:#1e0010>“</span><span style=color:#ae81ff>1</span><span style=color:#960050;background-color:#1e0010>”</span><span style=color:#66d9ef>:</span>
          <span style=color:#66d9ef>subset</span><span style=color:#66d9ef>.</span><span style=color:#66d9ef>append</span><span style=color:#f92672>(</span><span style=color:#66d9ef>set</span><span style=color:#f92672>[</span><span style=color:#66d9ef>i</span><span style=color:#f92672>]</span><span style=color:#f92672>)</span>
 power<span style=color:#f92672>.</span>append<span style=color:#f92672>(</span>subset<span style=color:#f92672>)</span>
      <span style=color:#66d9ef>return</span> power
</code></pre></div><p>But more importantly, it's essentially my algorithm. (And it didn't took
him an hour, read the post, it's interesting) And then I realised. This
is ugly. Quite ugly. It may be efficient and allow for doing iteration
and evaluating it lazily, but oh boy it's ugly. Can't it be done in a
simpler way?</p><h4 id=recursive-solution>Recursive solution</h4><p>So by asking how I <strong>compute</strong> a power set I obtained the imperative
algorithm above.</p><p><a href=http://commons.wikipedia.org/wiki/File%3ABalanced_tree.png><img src=http://upload.wikimedia.org/wikipedia/commons/thumb/3/33/Balanced_tree.png/300px-Balanced_tree.png alt="Balanced tree"></a></p><p>Time to change the question. What <strong>is</strong> a power set?</p><p>It's a set of leaves of a balanced binary decision tree. Every inner
node represents a decision to either take or leave out the element at
respective index(I assume elements are indexed). That is root node
responds to first element, it's children to second element, etc. Every
leaf can be computed by following the decision path.  It's
a <strong>recursive</strong> structure. So the tree can be decomposed to left and
right subtree and recombined. An this is repeated until you get to
leaves. So a power set of A is an union of the power set of &ldquo;A minus the
first element&rdquo; and the same power set again but with every subset added
the first element. Subtrees are represented by the two powersets and the
recombination by adding head element to one set of sets and then doing
the union. And to stop the recursion: power set of an empty set is a set
containing just an empty set.</p><p>Now let's do that in code, my language of choice now is scala</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-scala data-lang=scala><span style=color:#66d9ef>def</span> power<span style=color:#f92672>[</span><span style=color:#66d9ef>A</span><span style=color:#f92672>]</span><span style=color:#f92672>(</span>set<span style=color:#66d9ef>:</span> <span style=color:#66d9ef>List</span><span style=color:#f92672>[</span><span style=color:#66d9ef>A</span><span style=color:#f92672>]</span><span style=color:#f92672>)</span><span style=color:#66d9ef>:</span> <span style=color:#66d9ef>List</span><span style=color:#f92672>[</span><span style=color:#66d9ef>List</span><span style=color:#f92672>[</span><span style=color:#66d9ef>A</span><span style=color:#f92672>]</span><span style=color:#f92672>]</span> <span style=color:#66d9ef>=</span> set <span style=color:#66d9ef>match</span> <span style=color:#f92672>{</span>
    <span style=color:#66d9ef>case</span> <span style=color:#a6e22e>Nil</span> <span style=color:#66d9ef>=&gt;</span> <span style=color:#a6e22e>List</span><span style=color:#f92672>(</span><span style=color:#a6e22e>Nil</span><span style=color:#f92672>)</span>
    <span style=color:#66d9ef>case</span> head<span style=color:#66d9ef>:</span><span style=color:#66d9ef>:</span><span style=color:#66d9ef>tail</span> <span style=color:#f92672>=&gt;</span> power<span style=color:#f92672>(</span>tail<span style=color:#f92672>)</span> flatMap <span style=color:#f92672>(</span>set <span style=color:#66d9ef>=&gt;</span> <span style=color:#a6e22e>List</span><span style=color:#f92672>(</span>set<span style=color:#f92672>,</span> head<span style=color:#66d9ef>:</span><span style=color:#66d9ef>:</span><span style=color:#66d9ef>set</span><span style=color:#f92672>)</span><span style=color:#f92672>)</span>
<span style=color:#f92672>}</span>
</code></pre></div><p>Yay just four lines. and the last one barely matters. But I can do even
better. The same code in haskell</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-haskell data-lang=haskell><span style=color:#a6e22e>power</span> <span style=color:#66d9ef>[]</span> <span style=color:#f92672>=</span> [<span style=color:#66d9ef>[]</span>]
<span style=color:#a6e22e>power</span> (head<span style=color:#66d9ef>:</span>tail) <span style=color:#f92672>=</span> power tail <span style=color:#f92672>&gt;&gt;=</span> <span style=color:#a6e22e>\</span>set <span style=color:#f92672>-&gt;</span>[set, head<span style=color:#66d9ef>:</span>set]
</code></pre></div><p>So you apply the lambda that creates both
sides of the union to your list and then flatten it to produce the same
result. This code may look a bit cryptic at first sight but once you
parse the syntax you can grasp the intention much more quickly than the
imperative version. At least I can. Recursion is quite nice once you get
used to it.</p><hr width=100%><p style=color:#777>Last modified on 2012-09-21</p></div></div><nav class=post-pagination><a class=newer-posts href=/posts/2012-09-25-creating-a-language-6/>Next<br>Making a programming language Part 6 - functions</a>
<a class=older-posts href=/posts/2012-09-17-composition/>Previous<br>Pretty function composition in scala and asynchronous function composition on android</a></nav><div class=post-comment-wrapper></div></div></div></div></div><div id=single-column-footer>&copy;
2021
Andraz Bajt</div></div><script src=//js/journal.js></script></body></html>