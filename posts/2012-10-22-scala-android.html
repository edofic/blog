---
title: Setting up for scala development on Android
---

<table cellpadding="0" cellspacing="0" style="float: right; margin-right: 1em; text-align: right;"><tbody><tr><td style="text-align: center;"><a href="http://www.crunchbase.com/product/android" style="margin-bottom: 1em; margin-left: auto; margin-right: auto; text-align: clear:right;"><img alt="Image representing Android as depicted in Crun..." border="0" class="zemanta-img-inserted" height="70" src="http://www.crunchbase.com/assets/images/resized/0001/4601/14601v1-max-450x450.png" style="border: none; font-size: 0.8em;" width="200" /></a></td></tr><tr><td style="text-align: center; width: 153px;">Image via <a href="http://www.crunchbase.com/" target="_blank">CrunchBase</a></td></tr></tbody></table><table cellpadding="0" cellspacing="0" style="float: left; margin-right: 1em; text-align: left;"><tbody><tr><td style="text-align: center;"><a href="http://en.wikipedia.org/wiki/File%3AScala_logo.png" style="margin-bottom: 1em; margin-left: auto; margin-right: auto; text-align: clear:right;"><img alt="Scala (programming language)" border="0" class="zemanta-img-inserted" height="89" src="http://upload.wikimedia.org/wikipedia/en/thumb/8/85/Scala_logo.png/300px-Scala_logo.png" style="border: none; font-size: 0.8em;" width="320" /></a></td></tr><tr><td style="text-align: center; width: 300px;">Scala (programming language) (Photo credit: <a href="http://en.wikipedia.org/wiki/File%3AScala_logo.png" target="_blank">Wikipedia</a>)</td></tr></tbody></table><br /><br /><br /><br /><br /><br /><br /><br />I've been developing for android more than a year now and a few months in scala. So naturally I wanted to combine the two. But it's not dead simple. This is kinda a tutorial an a reference if I ever forget how to do this. It took me a few days to figure it all out. I tried maven, ant with special config and sbt(I need to learn more about this one) but in the end I just wanted fast solution integrated into my IDE.<br /><div><br /></div><div>So I use <a href="http://www.jetbrains.com/idea/" rel="homepage" target="_blank" title="IntelliJ IDEA">IntelliJ IDEA</a> community edition for my IDE.  You should check it out, it's totally awesome. It's primary a Java IDE but scala plugin rocks. It offers some more advanced text editing capabilities, not like vim or emacs but enough for me. It also brings up coloring and editing features that are language aware. So you have a shortcut(Ctrl-W) to select semantically valid block. And press it again to expand to next bigger valid piece of code. And stuff like that. Real-time structure view is nice and there are some cool refactorings. But scala <a href="http://en.wikipedia.org/wiki/Read–eval–print_loop" rel="wikipedia" target="_blank" title="Read–eval–print loop">REPL</a> is where fun begins. You get your module classpath pre-set and you get <b>full editor capabilities in REPL</b>. Enough with advertisement(they didn't pay me to do this) and let's get to work. </div><h3>Prerequisites</h3><div><ul><li>JDK...duh!  I use <a href="http://openjdk.java.net/projects/jdk7/" rel="homepage" target="_blank" title="OpenJDK">OpenJDK</a> 7, IDEA gives some warnings but it works like a charm</li><li><a href="http://en.wikipedia.org/wiki/Android_software_development" rel="wikipedia" target="_blank" title="Android software development">Android SDK</a> and at least one platform</li><li>IntelliJ IDEA</li><li>scala distribution. I recommend you use latest stable release from <a href="http://www.scala-lang.org/downloads" target="_blank">here</a> </li></ul><h3>Setting up</h3></div><div>First install scala plugin. It's quite straightforward. Plugin Manager->Browse repos->search for scala->select->ok.</div><div>Now actual setting up. I use global libraries for all my projects, you can also put these into just Libraries and to that on per-project basis.</div><div>Open project structure(no project open) and go to Global Libraries. You need to create two libraries containing jars from <path to scala>/lib/.</div><div>First scala-<a href="http://en.wikipedia.org/wiki/Compiler" rel="wikipedia" target="_blank" title="Compiler">compiler</a> with scala-compiler.jar and scala-library.jar and then scala-library with scala-library.jar and anything else you might need. Reason for scala library in compiler is that compiler also relies on scala lib. I needed quite some time to figure this out.</div><div>This whole process can be automated if you add scala to your project when creating it but it's not possible with android so you need to know how to do it by hand. </div><h3>Creating a project</h3><div><ul><li>Project from scratch</li><li>add android module and configure it</li><li>now go to project structure. add scala facet to this module and go to its settings and set the compiler jar.</li><li>back to module and add dependency to global scala-library</li><li>set dependency to <b>provided</b>. This is important. Else it will try to dex whole library and you'll end up with "too  many methods error".</li></ul><div>Now your project should compile. But not run.</div></div><h3>Running</h3><div>Obviously not including scala library in the build means you need to provide it in another way. For developing on emulator I customized it to provide predexed scala library. <a href="http://zegoggl.es/2011/07/how-to-preinstall-scala-on-your-android-phone.html" target="_blank">Excellent tutorial.</a></div><div>In a nutshell</div><pre><span style="background-color: #eeeeee; font-family: Courier, 'Courier New', monospace; font-size: 13.600000381469727px; line-height: 13.600000381469727px;">$ git clone git://github.com/jberkel/android-sdk-scala.git<br />$ cd android-sdk-scala<br />$ ./bin/createdexlibs</span><br /></pre><pre><span style="font-family: Courier, 'Courier New', monospace; font-size: 13.600000381469727px; line-height: 13.600000381469727px;">$ </span><span style="background-color: #eeeeee; font-family: Courier, 'Courier New', monospace; font-size: 13.600000381469727px; line-height: 13.600000381469727px;">bin/createramdisks</span></pre><pre><span style="font-family: Courier, 'Courier New', monospace; font-size: 13.600000381469727px; line-height: 13.600000381469727px;">$ </span><span style="background-color: #eeeeee; font-family: Courier, 'Courier New', monospace; font-size: 13.600000381469727px; line-height: 13.600000381469727px;">emulator -avd ... -ramdisk /path/to/custom.img<br /></span><span style="font-family: Courier, 'Courier New', monospace; font-size: 13.600000381469727px; line-height: 13.600000381469727px;">$ </span><span style="background-color: #eeeeee; font-family: Courier, 'Courier New', monospace; font-size: 13.600000381469727px; line-height: 13.600000381469727px;">adb shell mkdir -p /data/framework<br /></span><span style="font-family: Courier, 'Courier New', monospace; font-size: 13.600000381469727px; line-height: 13.600000381469727px;">$ </span><span style="font-family: Courier, 'Courier New', monospace; font-size: 13.600000381469727px; font-weight: bold; line-height: 13.600000381469727px;">for</span><span style="background-color: #eeeeee; font-family: Courier, 'Courier New', monospace; font-size: 13.600000381469727px; line-height: 13.600000381469727px;"> i </span><span style="font-family: Courier, 'Courier New', monospace; font-size: 13.600000381469727px; font-weight: bold; line-height: 13.600000381469727px;">in</span><span style="background-color: #eeeeee; font-family: Courier, 'Courier New', monospace; font-size: 13.600000381469727px; line-height: 13.600000381469727px;"> configs/framework/*<a href="http://en.wikipedia.org/wiki/JAR_%28file_format%29" rel="wikipedia" target="_blank" title="JAR (file format)">.jar</a>; </span><span style="font-family: Courier, 'Courier New', monospace; font-size: 13.600000381469727px; font-weight: bold; line-height: 13.600000381469727px;">do</span><span style="background-color: #eeeeee; font-family: Courier, 'Courier New', monospace; font-size: 13.600000381469727px; line-height: 13.600000381469727px;"> adb </span><span style="font-family: Courier, 'Courier New', monospace; font-size: 13.600000381469727px; line-height: 13.600000381469727px;">push</span><span style="background-color: #eeeeee; font-family: Courier, 'Courier New', monospace; font-size: 13.600000381469727px; line-height: 13.600000381469727px;"> </span><span style="font-family: Courier, 'Courier New', monospace; font-size: 13.600000381469727px; line-height: 13.600000381469727px;">$i</span><span style="background-color: #eeeeee; font-family: Courier, 'Courier New', monospace; font-size: 13.600000381469727px; line-height: 13.600000381469727px;"> /data/framework/; done</span></pre><div>And reboot.<br /><br />There is also (not so trivial) part about pathcing a device. However you can try <a href="https://play.google.com/store/apps/details?id=com.mobilemagic.scalainstaller&feature=search_result#?t=W251bGwsMSwxLDEsImNvbS5tb2JpbGVtYWdpYy5zY2FsYWluc3RhbGxlciJd" target="_blank">Scala Installer</a> from Play to do this. I had some success and some failures.<br /><br />Now the app should run on your device.<br /><h3>Deploying</h3></div><div>Well it doesn't work on other devices right now. For export you need to change scala-library dependency back to <b>compile </b>to include it into the build. Trick now is to enable ProGuard to remove unnecessary methods and classed to fit the jar through dexer. You do this in Tools-><a href="http://code.google.com/android/" rel="homepage" target="_blank" title="Android">Android</a>->Export. Select ProGuard and your config. I got mine from jberkel's repo. That's it. Sadly this export takes quite some time. Scala's standard library is not a piece of cake afterall(actually<b> it is</b> a cake). Minute and a half on my machine for small apps. So I only to this for testing on other phones and deployment.</div><h3>Faster compilation</h3><div>Compiling with scala-libray set to provided is much faster but not fast enough for me. I want to be doing stuff not <a href="http://xkcd.com/303/" target="_blank">waiting for it to compile</a>. </div><div>Turns out compiler is the big time sucker(and I'm being Capt. Obvious). Afterall scalac is not known for it's speed.</div><div>Enter <b>FSC </b>or Fast Scala Compiler. This is a scala compiler running in the background having everything preloaded and just does incremental compilation. It even comes with standard scala distribution and is supported by IntelliJ IDEA. Great. </div><div>To set it up just head over to Project Structure->Scala facet and select Use FSC. And then immediately click Setting to access Project Settings and set compiler jar for the compiler.</div><div>Success. Scala builds are now on par(or even faster!) than java ones. </div><div>No more fencing for me.</div><div style="margin-top: 20px; overflow: hidden;">